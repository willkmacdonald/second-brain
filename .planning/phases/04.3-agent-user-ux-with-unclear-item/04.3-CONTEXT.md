# Phase 04.3: Agent-User UX with Unclear Item - Context

**Gathered:** 2026-02-23
**Status:** Ready for planning

<domain>
## Phase Boundary

Improve how the app handles three distinct scenarios when classification goes wrong: (1) completely misunderstood items where the agent can't make sense of the input, (2) low-confidence classifications where the agent is uncertain, and (3) mis-categorized items where the agent was confident but wrong. Each scenario has a different UX flow.

</domain>

<decisions>
## Implementation Decisions

### Three distinct classification outcome flows

**Flow 1: Misunderstood (agent can't make sense of input)**
- Hybrid approach: agent guesses if it has any reasonable interpretation, asks open-ended "What did you mean?" if truly no idea
- Conversational, friendly tone — "I'm not quite sure what you meant by..."
- Happens immediately on capture screen — agent sends open-ended question, user responds via text
- Agent's question text remains visible above the text input so user knows they're replying to a follow-up (not starting a new capture)
- Same text input reused for the response (clears for reply)
- Agent re-runs classification on original text + user's clarification
- Maximum 2 follow-up exchanges; if still unresolved after 2 rounds, item goes to "unresolved" status in inbox
- Unresolved items stay in inbox with distinct status; user can open later to manually categorize or retry

**Flow 2: Low confidence (score under threshold but not misunderstood)**
- Item auto-filed as "pending" status — NO immediate user interaction required
- User discovers it later in inbox at their leisure
- Tapping a pending item in inbox opens detail card with: original user text + 4 bucket buttons for manual resolution
- This is the existing flow refined — pending items don't block the user

**Flow 3: Mis-categorized (high confidence, wrong bucket)**
- Item was auto-filed to wrong bucket
- User discovers it in inbox, taps to open detail card
- Detail card has 4 bucket buttons at the bottom
- Current bucket is visually highlighted so user knows where it's filed
- Tapping a different bucket recategorizes instantly — no confirmation dialog
- Toast confirms: "Moved to [Bucket]"
- Backend moves the record: deletes from wrong bucket container, creates in correct one
- Only available for classified items (not pending/unresolved)
- Bucket change only — no text editing in this flow

### Misunderstood vs low-confidence distinction

- Claude's discretion on the heuristic for distinguishing "misunderstood" from "low confidence"
- Could be a second lower threshold, score distribution analysis, or other approach
- Key behavior: misunderstood triggers immediate conversation; low confidence triggers silent pending status

### Inbox visual indicators

- Color-coded status dots in inbox list:
  - Orange dot: pending / low-confidence (needs user bucket selection)
  - Red dot: unresolved (agent couldn't classify after 2 follow-ups)
  - Green dot (or no dot): classified and filed successfully
- These replace or extend the existing orange dot for pending items

### Recategorize API design

- Claude's discretion on whether to create a new endpoint (e.g., PATCH /api/inbox/{id}/recategorize) or extend existing respond endpoint

### Claude's Discretion
- Heuristic for distinguishing misunderstood vs low-confidence (threshold, score distribution, etc.)
- API endpoint design for recategorize
- Exact animation/transition when recategorizing
- Loading states during re-classification in misunderstood flow

</decisions>

<specifics>
## Specific Ideas

- Agent tone should be conversational and friendly, not robotic — "I'm not quite sure what you meant by 'Aardvark'" not "Unable to classify. Provide context."
- The misunderstood flow is fundamentally different from low-confidence: it's a real-time conversation on the capture screen vs an async pending item in inbox
- Recategorize from inbox detail card: 4 bucket buttons at bottom of modal, current bucket highlighted, instant tap-to-move
- User noted that some intentionally ambiguous test inputs were rated high and auto-categorized — the classifier may be overconfident in some cases

</specifics>

<deferred>
## Deferred Ideas

- Voice as default response method for misunderstood follow-ups (after Phase 5 — Voice Capture)
- Text editing of raw capture text from inbox (not in scope for recategorize)
- Logging correction history for classifier improvement (keeping trace of original vs corrected bucket)

</deferred>

---

*Phase: 04.3-agent-user-ux-with-unclear-item*
*Context gathered: 2026-02-23*
