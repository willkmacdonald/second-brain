---
phase: 04.3-agent-user-ux-with-unclear-item
plan: 10
subsystem: classification
tags: [classifier, junk-detection, misunderstood, prompt-engineering, agent-instructions]

# Dependency graph
requires:
  - phase: 04.3-agent-user-ux-with-unclear-item
    provides: "Classifier agent with dual-threshold classification (plans 01-09)"
provides:
  - "Narrowed junk definition restricted to keyboard mashing, random chars, empty input"
  - "Reordered decision flow: classify -> misunderstood -> junk (was: junk -> classify -> misunderstood)"
  - "Explicit tiebreaker: prefer request_misunderstood over mark_as_junk when in doubt"
affects: [classifier, uat-testing, inbox-flow]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "Narrowed LLM tool selection via explicit inclusion/exclusion examples in instructions"
    - "Decision flow ordering to bias toward user engagement over silent discard"

key-files:
  created: []
  modified:
    - backend/src/second_brain/agents/classifier.py

key-decisions:
  - "Junk restricted to keyboard mashing, random chars, empty input, repeated chars -- removed 'nonsensical' overlap"
  - "Decision flow reordered: high confidence -> low confidence -> misunderstood -> junk (was junk first)"
  - "Dual tiebreaker placement: in decision flow step 3 AND in dedicated paragraph after misunderstood signals"

patterns-established:
  - "Explicit boundary examples in agent instructions to disambiguate overlapping tool definitions"

requirements-completed: [CLAS-04, APPX-04]

# Metrics
duration: 1min
completed: 2026-02-24
---

# Phase 04.3 Plan 10: Junk/Misunderstood Overlap Fix Summary

**Narrowed junk definition to strict gibberish-only and reordered classifier decision flow so misunderstood is checked before junk**

## Performance

- **Duration:** 1 min
- **Started:** 2026-02-24T18:26:31Z
- **Completed:** 2026-02-24T18:27:43Z
- **Tasks:** 1
- **Files modified:** 1

## Accomplishments
- Junk Detection section rewritten with strict criteria: keyboard mashing, random characters, empty input, repeated characters only
- Explicit exclusion added: any recognizable word/name/term must NOT be marked as junk (routes to request_misunderstood)
- Decision flow reordered from junk-first (1. junk, 2. high, 3. low, 4. misunderstood) to classify-first (1. high, 2. low, 3. misunderstood, 4. junk)
- "When in doubt" tiebreaker added in two locations: decision flow step 3 and dedicated paragraph after misunderstood signals
- Boundary examples added: Xyzzy -> request_misunderstood, asdfjkl -> mark_as_junk

## Task Commits

Each task was committed atomically:

1. **Task 1: Narrow junk definition, add exclusions, and reorder decision flow** - `e50f089` (fix)

**Plan metadata:** `491479e` (docs: complete plan)

## Files Created/Modified
- `backend/src/second_brain/agents/classifier.py` - Narrowed junk definition, reordered decision flow, added tiebreaker and boundary examples in classifier instructions

## Decisions Made
- Removed "accidental" and "nonsensical" from junk description -- these words created the overlap with misunderstood
- Decision flow reordering puts classification and misunderstood before junk, so LLM considers meaningful interpretations first
- Tiebreaker placed in two locations for reinforcement: inline in decision tree step 3 and as standalone paragraph

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered
None

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- Phase 04.3 gap closure complete (all 10 plans executed)
- Ready for UAT re-test to verify "Xyzzy" now enters conversation mode instead of being marked as junk
- All 43 backend tests pass with no regressions

## Self-Check: PASSED

- FOUND: backend/src/second_brain/agents/classifier.py
- FOUND: e50f089 (task 1 commit)

---
*Phase: 04.3-agent-user-ux-with-unclear-item*
*Completed: 2026-02-24*
